D:\study\codes\work2\IMIPL\venv\Scripts\python.exe D:\study\codes\work2\IMIPL\main2.py 
=== Training Settings ===
Epochs: 20
Learning Rate: 0.01
Positive Label Start From: 1
Bag Size: 64
Dataset: CIFAR10
Backbone: resnet18
Pooling Component: fsa
If no finetune,no backbone trained,no cl.Fine-tune: True
Contain Contrastive Term:  True
Files already downloaded and verified
D:\study\codes\work2\IMIPL\venv\lib\site-packages\torchvision\models\_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
D:\study\codes\work2\IMIPL\venv\lib\site-packages\torchvision\models\_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Test Accuracy: 6.82
epoch,lam =  0 0 0.0
Train Epoch 0: 100%|██████████| 10000/10000 [1:03:08<00:00,  2.64it/s, Training loss=2.73, critical_weights=0.436, std=0.09]
Test Accuracy: 40.16
Train Epoch 1:   0%|          | 0/10000 [00:00<?, ?it/s]Test Accuracy: 40.61
epoch,lam =  0 1 0.01
Train Epoch 1: 100%|██████████| 10000/10000 [1:11:30<00:00,  2.33it/s, Training loss=0.8, critical_weights=0.914, std=0.228]
Test Accuracy: 77.53
Test Accuracy: 77.83
epoch,lam =  0 2 0.02
Train Epoch 2: 100%|██████████| 10000/10000 [1:07:16<00:00,  2.48it/s, Training loss=0.1, critical_weights=0.971, std=0.221]
Test Accuracy: 79.23
Train Epoch 3:   0%|          | 0/10000 [00:00<?, ?it/s]Test Accuracy: 79.56
epoch,lam =  0 3 0.03
Train Epoch 3: 100%|██████████| 10000/10000 [1:11:36<00:00,  2.33it/s, Training loss=0.0685, critical_weights=0.975, std=0.213]
Test Accuracy: 80.47
Train Epoch 4:   0%|          | 0/10000 [00:00<?, ?it/s]Test Accuracy: 80.41
epoch,lam =  0 4 0.04
Train Epoch 4: 100%|██████████| 10000/10000 [1:11:41<00:00,  2.32it/s, Training loss=0.0795, critical_weights=0.975, std=0.209]
Test Accuracy: 79.62
Test Accuracy: 80.19
epoch,lam =  0 5 0.05
Train Epoch 5: 100%|██████████| 10000/10000 [1:11:52<00:00,  2.32it/s, Training loss=0.0835, critical_weights=0.974, std=0.212]
Test Accuracy: 80.81
Train Epoch 6:   0%|          | 0/10000 [00:00<?, ?it/s]Test Accuracy: 80.78
epoch,lam =  0 6 0.06
Train Epoch 6: 100%|██████████| 10000/10000 [1:11:54<00:00,  2.32it/s, Training loss=0.096, critical_weights=0.973, std=0.214]
Test Accuracy: 79.6
Train Epoch 7:   0%|          | 0/10000 [00:00<?, ?it/s]Test Accuracy: 79.58
epoch,lam =  0 7 0.07
Train Epoch 7: 100%|██████████| 10000/10000 [1:11:57<00:00,  2.32it/s, Training loss=0.116, critical_weights=0.972, std=0.217]
Test Accuracy: 77.8
Train Epoch 8:   0%|          | 0/10000 [00:00<?, ?it/s]Test Accuracy: 77.86
epoch,lam =  0 8 0.08
Train Epoch 8: 100%|██████████| 10000/10000 [1:11:59<00:00,  2.31it/s, Training loss=0.143, critical_weights=0.973, std=0.224]
Test Accuracy: 79.68
Test Accuracy: 79.43
epoch,lam =  0 9 0.09
Train Epoch 9: 100%|██████████| 10000/10000 [1:12:02<00:00,  2.31it/s, Training loss=0.152, critical_weights=0.978, std=0.239]
Test Accuracy: 78.58
Train Epoch 10:   0%|          | 0/10000 [00:00<?, ?it/s]Test Accuracy: 78.27
epoch,lam =  0 10 0.1
Train Epoch 10: 100%|██████████| 10000/10000 [1:12:04<00:00,  2.31it/s, Training loss=0.149, critical_weights=0.985, std=0.251]
Test Accuracy: 78.91
Test Accuracy: 79.17
epoch,lam =  0 11 0.1
Train Epoch 11: 100%|██████████| 10000/10000 [1:12:05<00:00,  2.31it/s, Training loss=0.149, critical_weights=0.984, std=0.252]
Test Accuracy: 78.76
Train Epoch 12:   0%|          | 0/10000 [00:00<?, ?it/s]Test Accuracy: 78.65
epoch,lam =  0 12 0.1
Train Epoch 12: 100%|██████████| 10000/10000 [1:12:07<00:00,  2.31it/s, Training loss=0.148, critical_weights=0.985, std=0.253]
Test Accuracy: 78.03
Train Epoch 13:   0%|          | 0/10000 [00:00<?, ?it/s]Test Accuracy: 77.96
epoch,lam =  0 13 0.1
Train Epoch 13: 100%|██████████| 10000/10000 [1:12:06<00:00,  2.31it/s, Training loss=0.148, critical_weights=0.985, std=0.253]
Test Accuracy: 76.98
Test Accuracy: 76.74
epoch,lam =  0 14 0.1
Train Epoch 14: 100%|██████████| 10000/10000 [1:11:58<00:00,  2.32it/s, Training loss=0.148, critical_weights=0.984, std=0.252]
Test Accuracy: 78.41
Test Accuracy: 78.23
epoch,lam =  0 15 0.1
Train Epoch 15: 100%|██████████| 10000/10000 [1:12:12<00:00,  2.31it/s, Training loss=0.147, critical_weights=0.983, std=0.252]
Test Accuracy: 77.85
Test Accuracy: 78.01
epoch,lam =  0 16 0.1
Train Epoch 16: 100%|██████████| 10000/10000 [1:12:16<00:00,  2.31it/s, Training loss=0.147, critical_weights=0.983, std=0.252]
Test Accuracy: 76.97
Train Epoch 17:   0%|          | 0/10000 [00:00<?, ?it/s]Test Accuracy: 77.3
epoch,lam =  0 17 0.1
Train Epoch 17: 100%|██████████| 10000/10000 [1:12:08<00:00,  2.31it/s, Training loss=0.148, critical_weights=0.983, std=0.251]
Test Accuracy: 77.77
Train Epoch 18:   0%|          | 0/10000 [00:00<?, ?it/s]Test Accuracy: 77.26
epoch,lam =  0 18 0.1
Train Epoch 18: 100%|██████████| 10000/10000 [1:12:07<00:00,  2.31it/s, Training loss=0.148, critical_weights=0.983, std=0.252]
Test Accuracy: 77.86
Test Accuracy: 78.11
epoch,lam =  0 19 0.1
Train Epoch 19: 100%|██████████| 10000/10000 [1:12:06<00:00,  2.31it/s, Training loss=0.147, critical_weights=0.983, std=0.251]
Test Accuracy: 77.87
[0.4016, 0.7753, 0.7923, 0.8047, 0.7962, 0.8081, 0.796, 0.778, 0.7968, 0.7858, 0.7891, 0.7876, 0.7803, 0.7698, 0.7841, 0.7785, 0.7697, 0.7777, 0.7786, 0.7787] [0.4361623300171923, 0.9140135751242342, 0.970667164349556, 0.9746242743968964, 0.9745966630399228, 0.9741245258510113, 0.9731728051781654, 0.9722767202064395, 0.9731661532968283, 0.9784715011060238, 0.9846064506471157, 0.9842529710650444, 0.9850125365972519, 0.9845765634357929, 0.983619293987751, 0.9833151291847229, 0.9830746127963066, 0.9830164837360382, 0.9830613404750824, 0.9827516918599606] [0.09000118349852564, 0.22810992319657233, 0.22090054132891818, 0.2131818489773199, 0.20919088749494402, 0.21247638977039604, 0.2140430351672694, 0.21683849189113827, 0.22350023112725467, 0.23889760468788446, 0.2514195582706481, 0.2520671808924526, 0.2527981000741944, 0.25284519343618306, 0.2520210515357554, 0.25209338391311464, 0.2518302535414696, 0.2513579294970259, 0.25175490651763976, 0.25115207997132094]
 
Process finished with exit code 0